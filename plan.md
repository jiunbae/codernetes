# Codex Master 개발 로드맵

Codex Master는 "노드 배치 + GitHub 레포지토리 선택 + 프롬프트 기반 작업 실행"을 목표로 하는 모노레포 프로젝트입니다. 아래 계획은 기능을 점진적으로 제공하기 위한 페이즈별 로드맵입니다.

## Phase 0 — 현재 상태 점검 (완료)
- WebSocket 기반 마스터 ↔ 노드 통신과 헬스 체크 유지
- Slack/Telegram 브릿지로 명령 수집 및 응답 전송
- React 대시보드로 노드 목록, 브로드캐스트, 설정/원격 노드 목업 UI 제공

## Phase 1 — Job & 노드 관리 토대 구축
- [ ] Job 도메인 모델 정의 (ID, 상태, 노드, 리포지토리, 프롬프트, 로그 경로 등)
- [ ] 영속 저장소 도입 (예: SQLite/PostgreSQL) 및 마이그레이션 스크립트 작성
- [ ] Job CRUD/실행 요청을 처리하는 REST/gRPC API 설계 및 구현
- [ ] 노드 메타데이터 등록 프로토콜 확장 (태그, 리소스, last capabilities)
- [ ] 작업 큐/스케줄러 기본 구현 (단일 노드 큐, 재시도 정책 초안)

## Phase 2 — 노드 에이전트 실행 파이프라인
- [ ] 노드에서 Job 수신 → 작업 디렉터리 생성 → Git 클론 → Codex 실행 흐름 구현
- [ ] GitHub HTTPS 토큰 주입 및 비밀 키 관리(임시 토큰 추상화)
- [ ] 실행 로그 스트리밍 (WebSocket 메시지 or 별도 채널) 및 에러 핸들링
- [ ] Job 완료/실패 시 마스터로 상태 업데이트 및 산출물(패치 등) 메타데이터 전송
- [ ] 작업 디렉터리 수명 주기/클린업 정책 수립

## Phase 3 — 프런트엔드/UX 확장
- [ ] React 대시보드에 "작업 생성" 모달/페이지 추가 (노드 선택, 레포 선택, 프롬프트 입력)
- [ ] Job 리스트/상세 페이지 구현 (상태 필터, 실시간 로그 뷰어, 산출물 링크)
- [ ] GitHub OAuth 연동 UI (로그인/토큰 상태 표시, 사용 가능한 레포 조회)
- [ ] Slack/Telegram 명령 → Job 생성 API 연동 (명령 템플릿 정의)
- [ ] 사용자 알림(토스트, Slack/Telegram 알림) 파이프라인 구축

## Phase 4 — 안정성/확장성 강화
- [ ] 메시지 브로커(예: Redis Streams/RabbitMQ) 도입 검토 및 PoC
- [ ] Job 실행 재시작/복구 전략 구현 (노드 장애 시 다른 노드로 재할당 등)
- [ ] 다중 노드 부하 분산 전략 (라운드 로빈, 태그 필터링)
- [ ] 보안 하드닝 (노드 격리, 자격 증명 암호화, 감사 로그)
- [ ] 성능 모니터링 및 관측성 (Prometheus 메트릭, 로그 표준화)

## Phase 5 — 운영 편의 기능
- [ ] 작업 템플릿/프롬프트 히스토리 저장 및 재사용
- [ ] 스케줄 작업(시간 기반 트리거) 지원
- [ ] 산출물 아카이브(S3/MinIO) 및 브라우저 뷰어 제공
- [ ] 사용자/팀별 권한 모델 및 감사 대시보드

---

### 다음 단계 제안
1. Phase 1의 Job 모델 및 DB 스키마 초안을 작성합니다.
2. 마스터 ↔ 노드 메시지 JSON 스키마를 Job 중심으로 재정의합니다.
3. 노드 에이전트에 대한 실행 환경(컨테이너/가상환경) 요구사항을 문서화합니다.

페이즈별 우선순위나 범위를 조정하고 싶으시면 알려주세요.
